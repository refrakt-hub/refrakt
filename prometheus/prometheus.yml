# Prometheus configuration for Refrakt Backend
# This file is used by the Prometheus Docker container to scrape metrics

global:
  scrape_interval: 10s      # Scrape targets every 10 seconds
  evaluation_interval: 10s  # Evaluate rules every 10 seconds
  scrape_timeout: 10s       # Timeout for scrape requests
  external_labels:
    cluster: 'refrakt'
    environment: '${ENVIRONMENT:-development}'

scrape_configs:
  # Scrape Refrakt Backend metrics
  - job_name: 'refrakt-backend'
    scrape_interval: 10s
    scrape_timeout: 10s
    metrics_path: '/metrics'  # Matches PROMETHEUS_METRICS_ROUTE default
    scheme: 'http'            # HTTP since we're on Docker network (not via tunnel)
    # bearer_token will be injected by docker-entrypoint.sh if PROMETHEUS_BEARER_TOKEN is set
    # bearer_token: ''
    
    static_configs:
      - targets:
          - 'host.docker.internal:8001'  # Local dev backend exposed on host
        labels:
          service: 'refrakt-backend'
          component: 'api'

